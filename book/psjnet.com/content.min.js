exports=async function(url,bid,cid,options){const{trimContentFragment,extractFragment,collectLines}=await require("transcode/parse_content"),{send}=require("http"),clientOptions={...options?.clientOptions,encoding:"gbk",followCookies:!0};let response=await send(url,clientOptions);assertOK(response);let html=response.body;const fetchId=html.subRegex(/url2disk\((\d+)\)/);if(fetchId){const URL=require("url"),uri=new URL(url);response=await send({url:uri.resolve(`/ajax.php?my=url2disk&id=${fetchId}&ttt=${new Date().getTime()}`),headers:{referer:url}},clientOptions),assertOK(response),html=response.body;}const fragment=await extractFragment(html,{cleaner:html=>trimContentFragment(html,/id="bodybox"[^>]*>/)}),result=[];return collectLines(fragment,result),formatBookContent(result)};