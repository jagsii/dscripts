exports=async function(bid,options){const{parseCatalog,cleanCatalogWrapper}=await require("transcode/parse_catalog"),url=`http://www.mfxsydw.com/book/${bid}.html`,clientOptions={...(options&&options.clientOptions)};return parseCatalog(url,null,{clientOptions,parser:async html=>{const URL=require("url"),uri=new URL(url);let fragment=cleanCatalogWrapper(html,/目录<\/span><\/h2>\s*<ul class="list"[^>]*>/,"</ul>");if(-1!==html.indexOf(`onclick="load_more('${bid}')"`)){const callback=html.subRegex(/var callback='([^']+)';/),{send}=require("http"),response=await send({url:uri.resolve(`/index.php?c=book&a=show.jsonp&callback=${callback}&book_id=${bid}&b=${function(_str){var _Mathtrunc=Math.trunc;const staticchars="PXhw7UT1B0a9kQDKZsjIASmOezxYG4CHo5Jyfg2b8FLpEvRr3WtVnlqMidu6cN";let encodechars=[];for(let i=0;i<_str.length;i++){const num0=staticchars.indexOf(_str[i]);let code=-1==num0?_str[i]:staticchars[(num0+3)%62];const num1=_Mathtrunc(62*Math.random()),num2=_Mathtrunc(62*Math.random());encodechars.push(staticchars[num1]+code+staticchars[num2]);}return encodechars.join("")}(callback)}`),headers:{Referer:url}},clientOptions);assertOK(response);const moreHtml=response.body,moreJsonStr=moreHtml.replace(/[^(]+\(/,"").replace(/\);\s*$/,"").trim(),moreJson=JSON.parse(moreJsonStr);fragment+=moreJson.content;}const catalog=[],matches=fragment.matchAll(/href="(?<url>[^"]+)"[^>]*>\s*<span[^>]*>(?<name>[^<]+)</g);for(let match of matches){const cid=/(?<id>\d+)\.html/.exec(match.groups.url).groups.id;catalog.push({id:cid,name:match.groups.name,url:uri.resolve(match.groups.url)});}return catalog}})};