exports=async function(bid,options){const{parseCatalogPaginate,cleanCatalogWrapper,hrefRecordRegex,getSelectLastOptionSubRegex}=await require("transcode/parse_catalog"),pageSize=250;let currentPage,lastCid,skipBegin=[],skipEnd=[];return parseCatalogPaginate(page=>(currentPage=page,"https://www.xswanshu.com"+(1===page?`/${bid.idPrefix()}_${bid}/`:`/booklist/${bid}/${page-1}/`)),{cleaner:html=>cleanCatalogWrapper(html,/<ul [^>]*section-list/,"</ul>",-1),recordRegex:hrefRecordRegex},{...options,clientOptions:{...(options&&options.clientOptions)},totalPagesTryPage:2,totalPagesRegex:html=>1===currentPage?2:getSelectLastOptionSubRegex(html,/\/booklist\/\d+\/(\d+)\//)?.intValue()+1,pageSize,preprocess:raw=>{lastCid=raw.subRegex(/og:novel:latest_chapter_url" content="[^"]*\/(\d+)\.html"/);for(let i of raw.subRegexAll(/\.ycxsid>li:nth-child\((\d+)\){display:none}/g))skipBegin.push(parseInt(i));for(let i of raw.subRegexAll(/\.ycxsid>li:nth-last-child\((\d+)\){display:none}/g))skipEnd.push(parseInt(i));return raw}}).then(_=>{if(lastCid&&1===_.paginate.pageNo&&1===_.paginate.totalPages&&_.catalog.length===pageSize&&_.catalog[_.catalog.length-1]!==lastCid&&(_.paginate.totalPages=2),0<skipBegin.length)for(let i of skipBegin)_.catalog[i-1]=null;if(0<skipEnd.length){let length=_.catalog.length;for(let i of skipEnd)_.catalog[length-i]=null;}return (0<skipBegin.length||0<skipEnd.length)&&(_.catalog=_.catalog.filter(__=>null!=__)),_})};