exports=async function(url,bid,cid,options){const CryptoJS=(await require("third-party/crypto-js"))(["md5","hmac","aes"]),{send}=require("http");let token=CryptoJS.HmacMD5(cid,VM_AGENT).toString();let response=await send({url:`https://www.wzry5.cn/read/Content/${cid}.js?token=${token}`,headers:{Referer:"https://www.wzry5.cn/load.html"}},options?.clientOptions);assertOK(response);let html=response.body;const path=CryptoJS.AES.decrypt(html,CryptoJS.enc.Utf8.parse(token.substr(0,16)),{iv:CryptoJS.enc.Utf8.parse(token.substr(16)),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Utf8),url2=`https://ebooktxt.oss-cn-shenzhen.aliyuncs.com${path}&t=${new Date().valueOf()}`;response=await send({url:url2,headers:{Referer:"https://www.wzry5.cn/"}},{...options?.clientOptions,encoding:"gbk"}),assertOK(response),html=response.body;const result=[],lines=html.split("\n");for(let n=0;n<lines.length;n++){if((3>n||n>lines.length-3)&&/^.{10,100}(net|cn|com|org|http|手打|http|域名|www|刷新|订阅|首发|网址|公众号|微信|APP|笔趣阁|顶点|小说|新书).{10,100}$/ig.test(lines[n]))continue;const lines2=lines[n].replace(/[\s ]/ig,"").split("\u3002");if(1==lines2.length)result.push(lines2[0]);else {let temp="";for(let m=0;m<lines2.length;m++)temp+=lines2[m],m<lines2.length-1&&(temp+="\u3002"),(100<temp.length||m==lines2.length-1)&&(result.push(temp),temp="");}}return formatBookContent(result)};