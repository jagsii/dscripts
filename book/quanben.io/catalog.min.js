exports=async function(bid,options){const{parseCatalog,cleanCatalogWrapper}=await require("transcode/parse_catalog"),url=`https://www.quanben.io/n/${bid}/list.html`,URL=require("url"),uri=new URL(url);return parseCatalog(url,null,{clientOptions:{...(options&&options.clientOptions)},parser:async html=>{const regex=/<a href="javascript:[^"]+" [^>]*onclick="load_more\('(\d+)'\)">[^<]+<\/a>/,num=html.subRegex(regex);if(num){const callback=html.subRegex(/callback\s*=\s*['"]([^'"\s+]+)['"]/),{send}=require("http"),response=await send({url:uri.resolve(`/index.php?c=book&a=list.jsonp&callback=${callback}&book_id=${num}&b=${function(_str){for(var _Mathtrunc=Math.trunc,staticchars="PXhw7UT1B0a9kQDKZsjIASmOezxYG4CHo5Jyfg2b8FLpEvRr3WtVnlqMidu6cN",encodechars="",i=0;i<_str.length;i++){var num0=staticchars.indexOf(_str[i]),code=-1==num0?_str[i]:staticchars[(num0+3)%62],num1=_Mathtrunc(62*Math.random()),num2=_Mathtrunc(62*Math.random());encodechars+=staticchars[num1]+code+staticchars[num2];}return encodechars}(callback)}`),headers:{referer:url}});assertOK(response);const h=response.body,json=JSON.parse(h.substring(h.indexOf("{"),h.lastIndexOf("}")+1));html=html.replace(regex,json.content);}const fragment=cleanCatalogWrapper(html,/class="list3"[^>]*>/,"class=\"footer\""),list=fragment.subRegexMapAll(/href=['"](?<url>[^'"]+)['"][^>]*>(?:\s*<span[^>]*>)?(?<name>[^<]+)</g),result=[];for(let c of list)c.name&&c.url&&(c.id=c.url.subRegex(/(\d+)\.html/),!!c.id)&&(c.url=uri.resolve(c.url),result.push(c));return result}})};