exports=async function(bid,options){const{parseCatalogPaginate}=await require("transcode/parse_catalog"),clientOptions={...(options&&options.clientOptions)};let lastCid,skipBegin=[],skipEnd=[];const pageSize=40;return parseCatalogPaginate(page=>`https://www.qudushu.cc/book/${bid}/${1===page?"":page-1+"/"}`,{fragmentRegex:/<ul class="[^"]*section-list[^"]*">(?<fragment>(?:\s*<li>\s*<a[^>]*>[^<]*<\/a>\s*<\/li>)+)/g,fragmentIndex:-1,recordRegex:/(?:href="(?<url>[^"]+)"|onclick="read_tz\((?<id>\d+)\)[^"]*")[^>]*>(?<name>[^<]+)</g},{...options,clientOptions,pageSize,totalPagesRegex:/value="\/book\/\d+\/(?<totalPages>\d+)\/"[^>]*>第\d+-\d+章<\/option>\s*<\/select>/,totalPagesOffset:1,urlBuilder:cid=>`https://www.qudushu.cc/book/${bid}/${cid}.html`,preprocess:raw=>{lastCid=raw.subRegex(/og:novel:latest_chapter_url" content="[^"]*\/book\/\d+\/(\d+)\.html"/);for(let i of raw.subRegexAll(/\.ycxsid>li:nth-child\((\d+)\){display:none}/g))skipBegin.push(parseInt(i));for(let i of raw.subRegexAll(/\.ycxsid>li:nth-last-child\((\d+)\){display:none}/g))skipEnd.push(parseInt(i));return raw}}).then(_=>{if(lastCid&&1===_.paginate.pageNo&&1===_.paginate.totalPages&&_.catalog.length===pageSize&&_.catalog[_.catalog.length-1]!==lastCid&&(_.paginate.totalPages=2),0<skipBegin.length)for(let i of skipBegin)_.catalog[i-1]=null;if(0<skipEnd.length){let length=_.catalog.length;for(let i of skipEnd)_.catalog[length-i]=null;}return (0<skipBegin.length||0<skipEnd.length)&&(_.catalog=_.catalog.filter(__=>null!=__)),_})};