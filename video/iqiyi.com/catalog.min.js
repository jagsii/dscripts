exports=async function(a,b){var c=Math.floor;async function d(a,b){let c=await e({url:a,headers:{referer:b}},{encoding:"utf-8"});assertOK(c);let d=c.body;const f=JSON.parse(d);return f.data[Object.keys(f.data)[0]].sort((c,a)=>c.tvId-a.tvId).map(a=>({id:/(v_[^.\/]+)\.html/.exec(a.playUrl)[1],name:a.name,url:a.playUrl}))}const{send:e}=require("http"),f=`https://m.iqiyi.com/${a}.html`;if(a.startsWith("v_"))return [{id:a,name:"\u5168\u96C6",url:f}];const[g,h]=b.recognizeExtra.split("+");if("year"===g){if(b.pageUrl){const a=await d(b.pageUrl,f);return a.forEach(a=>{a.url.startsWith("http://")&&(a.url=a.url.replace("http://","https://"));}),formatCatalog({paginate:{type:"urls",pageUrls:[],pageUrl:b.pageUrl},catalog:a})}let a=await e(f,{encoding:"utf-8","x-mobile":1});assertOK(a);let c=a.body;const g=c.subRegex(/window\.__INITIAL_STATE__=([^\n]+);\(function/);if(!g)return null;const i=JSON.parse(g),j="string"==typeof i.album.albumInfo.summaryInfo?[]:i.album.albumInfo.summaryInfo.map(a=>a.year).sort((c,a)=>c.localeCompare(a)).map(a=>`https://pcw-api.iqiyi.com/album/source/svlistinfo?sourceid=${h}&timelist=${a}`);let k,l=b.page??0;return 0===j.length?k=[]:(-1===l&&(l=j.length-1),k=await d(j[l],f),k.forEach(a=>{a.url.startsWith("http://")&&(a.url=a.url.replace("http://","https://"));})),formatCatalog({paginate:{type:"urls",pageUrls:j,pageUrl:j[l]},catalog:k})}else {const a=200;let d,g=b.page,i=b.chapterIndex;-1===g?(d=!0,g=null):d=!1,null==g&&(null==i?g=1:g=c(i/a)+1),1>g&&(g=1);let j=await e({url:`https://pcw-api.iqiyi.com/albums/album/avlistinfo?aid=${h}&size=${a}&page=${g}`,headers:{referer:f}},{encoding:"utf-8"});assertOK(j);let k=j.body,l=JSON.parse(k);const m=l.data.page;(d&&m>g||m<g)&&(g=m,j=await e({url:`https://pcw-api.iqiyi.com/albums/album/avlistinfo?aid=${h}&size=${a}&page=${g}`,headers:{referer:f}},{encoding:"utf-8"}),assertOK(j),k=j.body,l=JSON.parse(k));const n=l.data.epsodelist.map(a=>({id:/(v_[^.\/]+)\.html/.exec(a.playUrl)[1],name:a.name,url:a.playUrl}));return n.forEach(a=>{a.url.startsWith("http://")&&(a.url=a.url.replace("http://","https://"));}),formatCatalog({paginate:{pageNo:g,pageSize:a,totalPages:m},catalog:n})}};