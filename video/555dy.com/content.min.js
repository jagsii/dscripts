exports=async function(a,b,c,d){var e=Math.round;function f(a,b){let[c,d]=b;const e=i.enc.Utf8.parse(a),f=i.AES.encrypt(e,c,{iv:d,mode:i.mode.CBC,padding:i.pad.Pkcs7});return f.ciphertext.toString().toUpperCase()}function g(a,b){let[c,d]=b;const e=i.enc.Hex.parse(a),f=i.enc.Base64.stringify(e),g=i.AES.decrypt(f,c,{iv:d,mode:i.mode.CBC,padding:i.pad.Pkcs7});return g.toString(i.enc.Utf8)}const{send:h}=require("http"),i=(await require("third-party/crypto-js"))(["aes","hmac","sha256"]),j=require("utils/absolute_url"),k={encoding:"utf-8",...d.clientOptions};let l;if(l=await h(a,k),200>l.statusCode||299<l.statusCode)throw new Error(`Request failed with statusCode ${l.statusCode}, ${l.reasonPhrase}`);let m=l.body,n=/var player_aaaa=({[^<]+})<\/script>(?:\s*<div[^>]*>)+\s*<iframe [^>]*src="([^"]+)"[^>]+allow="autoplay"/.exec(m);if(!n)return null;const o=JSON.parse(n[1].trim()),p=o.url;if(!p)return null;const q=j(n[2],a);if(l=await h({url:q,headers:{referer:a}},k),200>l.statusCode||299<l.statusCode)throw new Error(`Request failed with statusCode ${l.statusCode}, ${l.reasonPhrase}`);if(m=l.body,n=/servers\s*=\s*\[([^\[\]]+)]/.exec(m),!n)return null;const r=n[1].split(",").map(a=>a.replace(/['"]/g,"").trim()),s=r[0];if(s.startsWith("ws")){const a=function(){return [i.enc.Utf8.parse("55ca5c48a943afdc"),i.enc.Utf8.parse("d11424dcecfe16c0")]},b=function(a){return i.HmacSHA256(a,"55ca5c4d11424dcecfe16c08a943afdc").toString()}(p),c=function(a){const b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b.buffer}(f(JSON.stringify({type:"getUrl",url:p,sign:b}),a()));let d;const e=await new Promise((a,b)=>{const e=require("websocket_client");d=new e(s,null,{headers:{Origin:q},onopen:function(){d.send(c);},onerror:function(){null!=d&&d.close(),b();},onmessage:function(b){a(b);}});});null!=d&&d.close();let h=JSON.parse(g(e,a()));return "url"!==h.type||h.url?{url:h.url}:null}else {const a=function(){return [i.enc.Utf8.parse("55cc5c42a943afdc"),i.enc.Utf8.parse("d11324dcscfe16c0")]},b=s+"/get_play_url",c=e(new Date().getTime()/1e3),d=i.MD5(s+"GET"+c+"55ca5c4d11424dcecfe16c08a943afdc").toString(),j=f(p,a()),k=i.HmacSHA256(j,d).toString(),l=i.MD5("www.555dy.com").toString(),m=i.MD5(VM_AGENT).toString(),n=i.MD5("https://zyz.sdljwomen.com").toString(),o=i.MD5(b.replace("http:","").replace("https:","")).toString(),q=await h({url:`${b}?app_key=${l}&client_key=${m}&request_token=${n}&access_token=${o}`,headers:{"X-PLAYER-TIMESTAMP":c.toString(),"X-PLAYER-SIGNATURE":k,"X-PLAYER-METHOD":"GET","X-PLAYER-PACK":j}});assertOK(q);const r=q.body,t=JSON.parse(g(r,a()));return {url:t.data.url}}};