function stepOverString(a,b){const d=b.charAt(a);++a;for(let e;a<b.length;){if(e=b.charAt(a),"\\"===e){a+=2;continue}if(b.charAt(a)===d)return a;a++;}return -1}function getScriptContent(a,b){const c=a;for(let d;a<b.length;){if(d=b.charAt(a),"'"===d||"\""===d){if(a=stepOverString(a,b),-1===a)return b.substring(c);a++;continue}if("<"===d&&a+7<b.length&&"/script"===b.substr(a+1,7).toLowerCase()){const d=a;for(a+=8;a<b.length;){if(">"===b.charAt(a))return b.substring(c,d);if(" "===b.charAt(a)){a++;continue}break}}a++;}return b.substring(c)}function getCommentTag(a,b){if(a+3>=b.length)return null;if("!"!==b.charAt(a+1)||"-"!==b.charAt(a+2)||"-"!==b.charAt(a+3))return null;const d="#comment",e=!0,f=a;a+=4;for(let g;a<b.length;){if(g=b.charAt(a),"-"===g&&a+2<b.length&&"-"===b.charAt(a+1)&&">"===b.charAt(a+2))return {name:d,open:e,begin:f,end:a+3,selfClosing:!0,extra:b.substring(f+4,a)};a++;}return {name:d,open:e,begin:f,end:b.length,extra:b.substring(f+4)}}function getTextTag(a,b){const c=a,d=!0,e="#text";for(a++;a<b.length;){if("<"===b.charAt(a))return {name:e,open:d,begin:c,end:a,extra:b.substring(c,a)};a++;}return {name:e,open:d,begin:c,end:b.length,extra:b.substring(c,b.length)}}function isTagChar(a){return 48<=a&&57>=a||97<=a&&122>=a||65<=a&&90>=a||45===a||58===a}function getTagName(a,b){const c=a;for(;a<b.length&&!!isTagChar(b.charCodeAt(a));)a++;return a===c?null:b.substring(c,a)}function getOpeningTag(a,b){const d=getTagName(a+1,b);if(!d)return null;const e=!0,f=a;a=a+d.length+1;const g=a;for(let h;a<b.length;){if(h=b.charAt(a),"'"===h||"\""===h){if(a=stepOverString(a,b),-1===a)return {name:d,open:e,attributes:b.substring(g,b.length),begin:f,end:b.length};a++;continue}if("<"===h)return {name:d,open:e,attributes:b.substring(g,a),begin:f,end:a};if(">"===h){const c="/"===b.charAt(a-1);return {name:d,open:e,attributes:b.substring(g,c?a-1:a),begin:f,end:a+1,selfClosing:c}}a++;}return {name:d,open:e,attributes:b.substring(g,b.length),begin:f,end:b.length}}function getClosingTag(a,b){if(a+1>=b.length||"/"!==b.charAt(a+1))return null;const c=getTagName(a+2,b);if(!c)return null;const d=a,e=!1;for(a+=2+c.length;a<b.length;){if(">"===b.charAt(a))return {name:c,open:e,begin:d,end:a+1};if("<"===b.charAt(a))return {name:c,open:e,begin:d,end:a};a++;}return {name:c,open:e,begin:d,end:b.length}}function htmlTokenize(a,b){b={filterEmptyString:!1,trimString:!1,trimAttributes:!0,lowerCaseTagName:!0,...b};const d=[];let e=0;const f=a.length;for(let g;e<f;){g=a.charAt(e);let c;if("<"===g&&(c=getCommentTag(e,a)||getOpeningTag(e,a)||getClosingTag(e,a),c)){b.lowerCaseTagName&&(c.name=c.name.toLowerCase()),e=c.end,c.attributes&&b.trimAttributes&&(c.attributes=c.attributes.trim()),void 0!==c.attributes&&0===c.attributes.length&&delete c.attributes,"script"===c.name.toLowerCase()&&c.open&&(c.extra=getScriptContent(e,a),c.extra&&(e+=c.extra.length)),d.push(c);continue}const f=getTextTag(e,a);b.trimString&&(f.extra=f.extra.trim()),(!b.filterEmptyString||0<f.extra.length)&&d.push(f),e=f.end;}return d}exports=htmlTokenize;