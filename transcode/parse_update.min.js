function parseRegex(a){if(a instanceof RegExp)return a;if(a instanceof Array)return a;if("Synopsis"===a)return [/更新：(?<updateTime>[^<]+)/,/class="directoryArea">\s*<p>\s*<a[^>]*>(?<name>[^<]+)</];if("block_txt2"===a)return /<p>更新(?:时间)?：(?<updateTime>[^<]*)<\/p>\s*<p>\s*最新(?:更新|章节)?：<a[^>]*>(?<name>[^<]*)</;if("meta"===a)return [/<meta [^>]*(?:property|name)=["']og:(?:novel:update_time|date)["'] ?content=["'](?<updateTime>[^"']+)["']/,/<meta [^>]*(?:property|name)=["']og:novel:las?t(?:est)?_chapter_(?:name|title)["'] ?content=["'](?<name>[^"']+)["']/];if("dd_box"===a)return /<dd>\s*<span[^>]*>更新：(?<updateTime>[^<]+)<\/span>\s*<\/dd>\s*<dd>\s*<span[^>]*>最新：<a[^>]*>(?<name>[^<]+)</;if("block-box"===a)return /最近更新：<\/span>\s*<a [^>]*>(?<name>[^<]+)<\/a>\s*<\/p>\s*<p class="time">\s*<span>更新时间：<\/span>(?<updateTime>[^<]*)/;if("pa"===a)return /更新(?:时间)?：\s*(?:<span[^>]*>)?(?<updateTime>[^<]*)(?:<\/span>)?\s*<\/p>\s*<p[^>]*>最新(?:章节)?：\s*<a[^>]+>(?<name>[^<]+)</;if("pap"===a)return /最[近新](?:更新|章节)：\s*(?:<\/span>)?<a[^>]+>(?<name>[^<]+)<\/a><\/p>\s*<p[^>]*>(?:<span[^>]*>)?(?:最后)?更新(?:时间)?：\s*(?:<\/span>)?(?<updateTime>[^<]+)</;if("li,li>a"===a)return /更新：(?<updateTime>[^<>]+)<\/li>\s*<li>最新(?:章节)?：<a[^>]*>(?<name>[^<>]+)</;if("li>a,li"===a)return /最[近新](?:更新|章节)?：<a[^>]*>(?<name>[^<>]+)<\/a>\s*<\/li>\s*<li[^>]*>更新(?:时间)?：(?<updateTime>[^<>]+)</;if("\u66F4\u65B0\uFF1Aa"===a)return /更新：<a[^>]+>(?<name>[^<]+)</;if("panel-body"===a)return /最新章节：<a[^>]+>(?<name>[^<]+)<\/a><span[^>]*>（(?<updateTime>[^）]+)）/;if(".pt-chapter"===a)return [/og:novel:update_time" content="(?<updateTime>[^"]+)"/,/pt-chapter-cont-detail">\s*<a[^>]+>(?<name>[^<]+)</];throw new Error(`unknown ParseUpdate regex ${a}`)}async function parseUpdate(a,b,c){c=c||{};const d={encoding:"utf-8","x-mobile":1,...c.clientOptions};let e;if(c.webview){const b=require("webview_fetch");e=await b(a,{mobile:1===d["x-mobile"],...c.webviewOptions});}else {const b={url:a,...c.httpOptions};c.lvt&&(!b.headers&&(b.headers={}),b.headers={cookie:lvtCookie(c.lvt)});const{send:f}=require("http");stat("request");let g=await f(b,d);if(stat("request"),c.onBlocked&&isBlocked(g))return c.onBlocked().then(formatUpdate);if(null!=c.retry&&(g=await handleRequestRetry(g,b,d,f,c.retry)),c.fallbackToWebview&&c.fallbackToWebview(g)){const b=require("webview_fetch");e=await b(a,{mobile:1===d["x-mobile"],...c.webviewOptions});}else assertOK(g),e=g.body;}null!=c.preprocess&&(e=await c.preprocess(e));const f={url:a,name:"",updateTime:null};if(c.parser)return await c.parser(e,f),formatUpdate(f);if("function"==typeof b){const a=b(e);return f.name=a.name,"string"==typeof a.updateTime?f.updateTime=parseDate(a.updateTime,c.format):null!=a.updateTime&&(f.updateTime=a.updateTime),formatUpdate(f)}else {let a=parseRegex(b);stat("match");let d;if(a instanceof Array){d={};for(let b of a)Object.assign(d,e.subRegexMap(b));}else {let b=a.exec(e);null!=b&&(d=b.groups);}if(stat("match"),null==d)return null;if(f.name=d.name,d.updateTime){let a=d.updateTime.trim();/\d{4}[\/-]\d{2}[\/-]\d{2} \d{2}:\d{2}:\d{3,}/.test(a)&&(a=a.substring(0,19)),f.updateTime=parseDate(a,c.format);}return formatUpdate(f)}}exports.parseUpdate=parseUpdate;