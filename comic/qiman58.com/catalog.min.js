exports=async function(bid,options){const{send}=require("http"),URL=require("url"),{cleanCatalogWrapper}=await require("transcode/parse_catalog"),url=`http://www.qiman59.com/${bid}/`,clientOptions={...(options&&options.clientOptions)};let response=await send(url,clientOptions);assertOK(response);let html=response.body,fragment=cleanCatalogWrapper(html,/id="chapter-list1">/,"</div>");const matches=fragment.matchAll(/href="(?<url>[^"]+)"[^>]*>(?<name>[^<]+)</g),uri=new URL(url),catalog=[];for(let match of matches){const chapterUrl=match.groups.url,cid=/(?<id>\d+)\.html/.exec(chapterUrl).groups.id,record={id:cid,name:match.groups.name,url:uri.resolve(chapterUrl)};catalog.push(record);}return -1!==html.indexOf("class=\"moreChapter\" onclick")&&(response=await send({url:uri.resolve("/bookchapter/"),method:"POST",body:`id=${bid}&id2=1`,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:url,"X-Requested-With":"XMLHttpRequest"}},clientOptions),assertOK(response),JSON.parse(response.body).forEach(_=>{catalog.push({id:_.chapterid,name:_.chaptername,url:uri.resolve(`/${bid}/${_.chapterid}.html`)});})),formatCatalog(catalog.reverse())};